---
phase: 03-reference-neutralization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/references/model-profiles.md
  - get-shit-done/references/model-profile-resolution.md
autonomous: true

must_haves:
  truths:
    - "model-profiles.md describes profiles using reasoning/standard/fast tier names with provider-neutral rationale"
    - "model-profile-resolution.md documents the full resolution flow: profile → tier → provider detection → model ID"
    - "Design rationale sections explain tiers in model-neutral terms"
  artifacts:
    - path: "get-shit-done/references/model-profiles.md"
      provides: "Profile definitions using abstract tiers"
      contains: "reasoning"
    - path: "get-shit-done/references/model-profile-resolution.md"
      provides: "Full resolution flow documentation"
      contains: "detectRuntime"
  key_links:
    - from: "get-shit-done/references/model-profiles.md"
      to: "get-shit-done/bin/gsd-tools.js"
      via: "Tier names match MODEL_PROFILES in code"
      pattern: "reasoning|standard|fast"
    - from: "get-shit-done/references/model-profile-resolution.md"
      to: "get-shit-done/bin/gsd-tools.js"
      via: "Documents detectRuntime() and PROVIDER_MODELS flow"
      pattern: "PROVIDER_MODELS|detectRuntime"
---

<objective>
Update the two reference documents that describe the model system in detail to use abstract tier names instead of Claude-specific model names.

Purpose: These are the authoritative reference docs for the model system. They must reflect the abstract tier architecture built in Phase 2, so any model reading them understands the tier-based system rather than seeing another model family's branding.

Output: Two fully updated reference files with provider-neutral language.
</objective>

<execution_context>
@/Users/lupickup/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/lupickup/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-reference-neutralization/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Neutralize model-profiles.md</name>
  <files>get-shit-done/references/model-profiles.md</files>
  <action>
Update get-shit-done/references/model-profiles.md with these specific changes:

**Line 3 — Introduction:**
Replace: `Model profiles control which Claude model each GSD agent uses.`
With: `Model profiles control which AI model tier each GSD agent uses. Abstract capability tiers are resolved to provider-specific models at runtime.`

**Lines 7-19 — Profile Definitions table:**
Replace all model names with abstract tiers:
- `opus` → `reasoning`
- `sonnet` → `standard`
- `haiku` → `fast`

The table header row and agent names stay the same. Only cell values change.

**Lines 23-37 — Profile Philosophy section:**
Replace entire section with:
```
**quality** - Maximum reasoning power
- Reasoning tier for all decision-making agents
- Standard tier for read-only verification
- Use when: quota available, critical architecture work

**balanced** (default) - Smart allocation
- Reasoning tier only for planning (where architecture decisions happen)
- Standard tier for execution and research (follows explicit instructions)
- Standard tier for verification (needs reasoning, not just pattern matching)
- Use when: normal development, good balance of quality and cost

**budget** - Minimal cost
- Standard tier for anything that writes code
- Fast tier for research and verification
- Use when: conserving quota, high-volume work, less critical phases
```

**Lines 39-48 — Resolution Logic section:**
Update step 3 from `3. Look up agent in table above` to `3. Look up agent's tier (reasoning/standard/fast) in table above`
Add new step 4: `4. Resolve tier to provider-specific model ID (see model-profile-resolution.md)`
Renumber old step 4 ("Pass model parameter") to step 5.

**Lines 61-73 — Design Rationale section (NEUT-07):**
Replace all four rationale entries:
- "Why Opus for gsd-planner?" → "Why reasoning-tier for gsd-planner?"
- "Why Sonnet for gsd-executor?" → "Why standard-tier for gsd-executor?"
- "Why Sonnet (not Haiku) for verifiers in balanced?" → "Why standard-tier (not fast) for verifiers in balanced?"
  Body: change "Sonnet handles this well; Haiku may miss" → "Standard-tier models handle this well; fast-tier may miss"
- "Why Haiku for gsd-codebase-mapper?" → "Why fast-tier for gsd-codebase-mapper?"

Do NOT change anything in the "Switching Profiles" section (lines 50-58) — it's about config mechanics, not model names.
  </action>
  <verify>
Run: `grep -n 'Opus\|Sonnet\|Haiku\|opus\|sonnet\|haiku' get-shit-done/references/model-profiles.md`
Must return ZERO results. Then read the file to confirm the tier names are correct and the table is well-formatted.
  </verify>
  <done>model-profiles.md uses only reasoning/standard/fast tier names. Profile definitions table, philosophy section, resolution logic, and design rationale all use provider-neutral language. No Claude model names remain.</done>
</task>

<task type="auto">
  <name>Task 2: Rewrite model-profile-resolution.md with full provider flow</name>
  <files>get-shit-done/references/model-profile-resolution.md</files>
  <action>
Rewrite get-shit-done/references/model-profile-resolution.md to document the full resolution flow built in Phase 2. The current file is 33 lines and only describes reading config + looking up a table. It needs to document: profile → tier → detectRuntime() → PROVIDER_MODELS → model ID, plus the GSD_MODEL override.

Keep the file title "# Model Profile Resolution" and the purpose of "resolve model profile once at start of orchestration."

**New content structure:**

1. **Resolution Flow** — numbered steps:
   1. Check `GSD_MODEL` env var — if set, return it directly (overrides everything)
   2. Read `model_profile` from `.planning/config.json` (default: `balanced`)
   3. Look up agent in `MODEL_PROFILES[profile]` → get abstract tier (`reasoning`, `standard`, `fast`)
   4. Detect runtime via `detectRuntime()` — checks GSD_RUNTIME > OPENCODE=1 > GEMINI_API_KEY > CLAUDE_CODE_SSE_PORT > `claude` fallback
   5. Look up `PROVIDER_MODELS[runtime][tier]` → get provider-specific model ID
   6. Return model ID to caller

2. **Abstract Tiers** — brief definitions:
   - `reasoning` — Highest capability. Architecture decisions, goal decomposition, complex analysis.
   - `standard` — Solid capability. Code execution, research, verification, follows explicit instructions well.
   - `fast` — Quick and efficient. Read-only tasks, pattern extraction, structured output.

3. **Provider Resolution** — explain that abstract tiers map to different model IDs per provider. Reference `PROVIDER_MODELS` in `gsd-tools.js` as source of truth. Do NOT duplicate the full table — just explain the concept and name a few examples:
   - `reasoning` → `opus` on Claude Code, `anthropic/claude-sonnet-4-20250514` on OpenCode (Claude), `openai/o3` on OpenCode (Codex)
   - Different runtimes, same tier name, provider-appropriate model

4. **Override Mechanism** — `GSD_MODEL=<model-id>` env var takes absolute precedence. Example: `GSD_MODEL=gpt-5.3-codex node gsd-tools.js resolve-model gsd-planner` returns `gpt-5.3-codex`.

5. **Usage** — keep the existing pattern of "resolve once, store, look up per agent" but update the Task example:
   ```
   model="{resolved_model}"  # e.g., "reasoning" tier → "opus" on Claude Code
   ```

6. **Backward Compatibility** — Claude Code users see no change: reasoning→opus, standard→sonnet, fast→haiku.

The file should be ~60-80 lines (expanded from 33, but not bloated). Use the same markdown style as the existing file.

Reference gsd-tools.js PROVIDER_MODELS table (lines ~146-177) for accuracy on provider model IDs, but do NOT copy the entire table into the doc.
  </action>
  <verify>
Run: `grep -n 'Opus\|Sonnet\|Haiku\|opus\|sonnet\|haiku' get-shit-done/references/model-profile-resolution.md`
Should return ZERO results (the word "opus" may appear in a provider example like "→ opus on Claude Code" — that's acceptable in an illustrative context showing what the tier resolves TO, but should not appear as a tier name itself). Read the file to confirm it documents the full 6-step resolution flow and all sections are present.
  </verify>
  <done>model-profile-resolution.md documents the complete resolution flow: GSD_MODEL override → profile lookup → tier → detectRuntime() → PROVIDER_MODELS → model ID. Includes tier definitions, provider resolution explanation, override mechanism, and backward compatibility note. No Claude model names used as tier names or quality descriptors.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `grep -rn '\b[Oo]pus\b\|\b[Ss]onnet\b\|\b[Hh]aiku\b' get-shit-done/references/model-profiles.md get-shit-done/references/model-profile-resolution.md` — should return zero results (or only illustrative provider examples in resolution doc)
2. Both files should be well-formatted markdown with no broken tables
3. model-profiles.md tier values must match MODEL_PROFILES in gsd-tools.js
4. model-profile-resolution.md must cover all 6 resolution steps
</verification>

<success_criteria>
- model-profiles.md uses reasoning/standard/fast in all profile definitions, philosophy, and rationale
- model-profile-resolution.md documents the full provider resolution flow from Phase 2
- No Claude model names used as quality descriptors in either file
- NEUT-01, NEUT-02, and NEUT-07 requirements satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/03-reference-neutralization/03-01-SUMMARY.md`
</output>
